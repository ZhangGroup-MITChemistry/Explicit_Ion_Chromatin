# Test system for LAMMPS simulation

units               real
atom_style          awsemmd
boundary            s s s
newton              on  #yes

#   ---         Variables for debye huckel potential        ---     #
#   parallel replica temperatures
variable            T   equal   300     
variable            rseed   equal   12345

variable            salt        equal   100.0       # Salt concentration [mM]
variable            random      equal   12345
variable            ldby        equal   9.618854    # debye screen length, depend on both T and salt, determined from known formula given that dielec=78
variable            ldbi        equal   1.0/v_ldby  # debye screen length
variable            cut_coul    equal   v_ldby*4.0  # coulombic cutoff is four times the debye length. 
                                                    # This is consistent with the DNA model
variable            cut_lj      equal   15.0
variable            cut_lj_pair equal   20.0
variable            dielec      equal   78.0

read_data           ../setup/post_processing/data.histone 
#read_dump           DUMP_FILE.dcd.bak 9 x y z  format molfile dcd /home/xclin/lib/vmd/plugins/LINUXAMD64/molfile

variable            inputdir    string "../setup/post_processing"
# Specify the different interaction styles
bond_style          hybrid harmonic list list/ca ${inputdir}/prot_list_files/ca_bond_list.txt
angle_style         hybrid stacking/3spn2   list    ${inputdir}/dna_list_files/in00_angl.list list/ca ${inputdir}/prot_list_files/ca_angle_list.txt
dihedral_style      hybrid list ${inputdir}/dna_list_files/in00_dihe.list list/ca ${inputdir}/prot_list_files/ca_dihed_list.txt


pair_style          hybrid/overlay lj12/cut/coul/debye ${inputdir}/prot_list_files/exclusion_list.txt ${ldbi} ${cut_lj} ${cut_coul} list ${inputdir}/prot_list_files/ca_pair_list.txt ${cut_lj_pair} nocheck lj/cut/coul/debye ${ldbi} 10.0 ${cut_coul}
pair_coeff          * * list

dielectric          ${dielec} 

# read in pair interaction
include           ${inputdir}/forcefield/proteinDna_pairCoeff.in
## shift the cutoff energy
pair_modify         shift yes

include           ${inputdir}/forcefield/bonded_ff.txt

# ---     from AWSEM simulation   ---
neighbor            10      bin
neigh_modify delay 5
#neighbor            5      bin 
#neigh_modify        check  yes     one 5000    # this avoids the error "boost neigh_modify one"
atom_modify         sort 0 0.0
#special_bonds       fene
special_bonds       lj 0.0 0.0 0.0

#   ---         group definitions       --- #
include             ${inputdir}/groupsDefinition/group_rigid.txt
group nonRigidBody subtract all nucl1 nucl2 nucl3 nucl4
#group2ndx           groups.ndx  


#####################################################
# A timestep of 0.02 ps
timestep            10.0
thermo              5000

dump                1 all dcd 50 DUMP_FILE.dcd
dump_modify         1 sort id

velocity            all create ${T} ${random} rot yes mom yes dist gaussian

restart             500 state_temp${T}.1.cpt state_temp${T}.2.cpt

#fix                 3 all colvars input.colvars output out_temp${T}
#fix_modify          3 energy yes

#####################################################
#   ---         Parallel Tempering      ---     #
fix             1   all nve
fix             3 all langevin ${T} ${T} 1000.0 ${rseed}
#fix             3 nonRigidBody langevin ${T} ${T} 1000.0 ${rseed}
#fix             pl all plumed plumedfile plumed_pulling.ini.dat outfile plumed.out
#fix             rigidBody all rigid group 4 nucl1 nucl2 nucl3 nucl4 langevin ${T} ${T} 1000.0 428984


minimize        1.0e-4 1.0e-6 100 1000
run                 2500
